Malware Analysis Report - [Sample Filename]

1. File Information
-------------------
- Filename:PO-465514-180820.doc
- File type: MS Word Document
- MD5:d7e6921bfd008f707ba52dee374ff3db 
- File Size:174.65 KB 
- Submission Date:
  First Submission: 2020-08-18 10:27:08 UTC
  Last Submission: 2025-02-07 12:29:44 UTC 

2. Static Analysis
------------------
- VirusTotal Scan Results
-Found as : Trojan downloader trojan vba macros
-Major Sources:Elastic Avast Bitdefender
-Connections:
 -Malicious ips:1)154.221.18.149 
 2)163.44.198.61 
 3)63.247.140.170
 4)68.44.137.144
 5)87.248.205.0
 -Malicious urls contacted:
  1)http://bike-nomad.com/cgi-bin/7n_0x0_62mnzyh9q/ 
  2)http://52550750-56-20180826151453.webstarterz.com/savewayexpressthai.com/jnze_2o3j_k/ 
  3)https://www.msbc.kz/data/k527_5_cbdvv5bi19/ 
  4)http://oubaina.com/wp-includes/lqkz_nvr_1avf4/
  5)https://68.44.137.144/K2zKLcHuSXI8q/AlVPAcDc24G/dtjVs/OOd5NbAAV8APxNtZ1G/8fNRAc3vacSJ2ryfacN/PNk4KULe2/ 
 -Malicous Domains contacted:
  1)bike-nomad.com
  2)cpanel12wh.bkk1.cloud.z.com
  3)msbc.kz
  4)okcupidating.com
  5)oubaina.com
  6)webstarterz.com
-Execution-Parents:1)Confidential_Report.doc (1).zip 

-Malicious-Bundeled-Files:
1)Qh300jh2fz8xvw.frm(VBA) 
2)G6srlicitafymaaqhy 

-Malicious-Dropped-Files:
 -windows-shortcuts:
 PO-465514-180820.LNK 
 document.LNK 
 design.LNK
 readme.LNK 
 -word document:
 DFDF459D7FCD110FF5.TMP


- File Metadata (ExifTool/OLETools)
File Name                       : PO-465514-180820.doc
Directory                       : .
File Size                       : 179 kB
File Modification Date/Time     : 2023:03:01 05:55:13-05:00
File Access Date/Time           : 2025:02:07 15:49:35-05:00
File Inode Change Date/Time     : 2025:02:07 15:43:42-05:00
File Permissions                : -rw-r--r--
File Type                       : DOC
Author                          : Alexandre Riviere
Create Date                     : 2020:08:18 08:19:00
Modify Date                     : 2020:08:18 08:19:00


-Ole tools results:
 -oleid:
 --------------------+--------------------+----------+--------------------------
 VBA Macros          |Yes, suspicious     |HIGH      |This file contains VBA    
                    |                    |          |macros. Suspicious        
                    |                    |          |keywords were found. Use  
                    |                    |          |olevba and mraptor for    
                    |                    |          |more info.                
 --------------------+--------------------+----------+--------------------------
 -olevba:
 +----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|showwindow          |May hide the application                     |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|ChrW                |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+
-obfuscated hex and base64 strings 
-malicious code/scripts
-The macros are likely obfuscated (hidden and encoded) to evade detection.

|Hex String|'u/C'              |A6752F43                                     |
|Hex String|'>w'            |C23EE977CCE3                                 |
|Hex String|'G\x05k'           |47056B96                                     |
|Hex String|' \x7fY\x1b'      |B0207F8E591B                                 |
+----------+--------------------+---------------------------------------------+

-VBA EXAMPLES:
VBA FORM Variable "b'Pqp_eb8h338dy5lm3_'" IN 'PO-465514-180820.doc' - OLE stream: 'Macros/Qh300jh2fz8xvw'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Sww07e74f7nnd_5ek'
-------------------------------------------------------------------------------
VBA FORM Variable "b'Mpgwimm87k05y'" IN 'PO-465514-180820.doc' - OLE stream: 'Macros/Qh300jh2fz8xvw'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'Bjdh0k5vq0ecwdt'" IN 'PO-465514-180820.doc' - OLE stream: 'Macros/Qh300jh2fz8xvw'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------

   
3. Dynamic Analysis
-------------------
- Process Activity (Parent/Child Processes, Command Execution):
  *A suspicious powershell.exe is executed as the worddoc is opened
  
- Network Activity (Connections, Domains, Ports, Data Exfiltration):
  all these connections are made by the process powershell.exe launched after opening the wordDOC
  -malicious ip connections(possible c2cs):
  182.237.1.58
  195.210.46.42
  216.170.124.4
  -malicious domains contacted:
  oubaina.com
  www.msbc.kz
  bike-nomad.com
  okcupidating.com
  52550750-56-20180826151453.webstarterz.com
  -malicious urls contacted:
  http://oubaina.com/wp-includes/lqkz_nvr_1avf4/
  
  
- Persistence Mechanisms (Scheduled Tasks, Registry Modifications, Dropped Files):
 -multiple dropped files by the processes WINWORD.exe and powershell.exe
 -including .bin,.txt and even XML 
 
  

4. Observations & Summary
-------------------------
- Malware Type:Trojan downloader trojan vba macros
- Impact:
  -Unauthorized remote access and potential data exfiltration via established C2 channels.
  -Downloading and execution of additional malicious payloads, increasing risk of system compromise.
  -Persistent malware presence due to dropped files and potential registry modifications.
  
- Recommended Actions:
  -immediate containment of the infected host machine
  -dfir process must begin
  -measures to avoid such incidents in future must be taken such as blacklisting the malicious ips,domains and urls found
  
  

