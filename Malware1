Malware Analysis Report - [Sample Filename]

1. File Information
-------------------
- Filename:baddoc.doc
- File Type:Word document
- Hashes (MD5):
a3b613d128aace09241504e8acc678c2 
- File Size:62.50 
- Submission Date:2015-02-10 15:39:02 UTC

2. Static Analysis
------------------
- VirusTotal Scan Results
-Found as TrojanDownloader,vba macro amd Trojan
-Major Sources:Elastic,Avast and BitDefender
-Connections:
 -Malicious ips:91.220.131.44
-Execution-Parents: 	test.doc.zip  	baddoc.zip 
-Malicious-Bundeled-Files:
ThisDocument.cls (vba)
-Malicious-Dropped-Files:
adobeacd-update.vbs
baddoc.LNK
adobeacd-update.vbs 
design.LNK 
~WRF{C909C7D8-0FA5-43AF-9FD2-52517C6EC6DD}.tmp 

- File Metadata (ExifTool/OLETools)
-ExifTool:
 -Metadata:
 File Modification Date/Time     : 2023:03:02 04:38:01-05:00
 File Access Date/Time           : 2025:02:06 17:05:58-05:00
 File Inode Change Date/Time     : 2025:02:06 16:38:33-05:00
 File Permissions                : -rw-rw-r--
 Comp Obj User Type              : �������� Microsoft Word 97-2003
 Create Date                     : 2015:02:08 19:56:00

 -Threats:
 Language Code                   : Russian


- Strings Analysis (Suspicious Text & Commands)
Iocs:
 -critical file locations:
   1)\AppData\Local\Temp\
   *And many more critical file locations found
 -malicious files:
   1)\Temp\VB
   *multiple occurence seems like vba macros
 -malicious code/scripts:
   1)Select * from Win32_OperatingSystem
   2)@echo off
   *malicious system commands found like above.
 
 -malicious ips:
  1)91.220.131
  *matches with the virustotal provided ip(possible C2C server)
 
 -malicious External Objects inclusion:
  1)Set objXML
  
 -suspicious hex and base64 strings extracted

-Ole tools results:
OLEID:
 -VBA Macros          |Yes, suspicious     |HIGH      |This file contains VBA    
                    |                    |          |macros. Suspicious        
                    |                    |          |keywords were found. Use  
                    |                    |          |olevba and mraptor for    
                    |                    |          |more info.              
                      
 *will use olevba for further analysis as vba macros has been detected.
OLEVBA:
 +----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |Auto_Open           |Runs when the Excel Workbook is opened       |
|AutoExec  |Workbook_Open       |Runs when the Excel Workbook is opened       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbNormal            |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|User-Agent          |May download files from the Internet         |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|system              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |1.3.1.2             |IPv4 address                                 |
|IOC       |2.2.1.1             |IPv4 address                                 |
|IOC       |1.1.2.2             |IPv4 address
                                                                              |
|Suspicious|User-Agent          |May download files from the Internet         |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
+----------+--------------------+---------------------------------------------+
NOTE:
*obfuscated strings found using chr
*separated strings using '+' and '&'
*THERE ARE MULTIPLE JUST HAVE MENTIONED FEW OF THE EXAMPLES TO KEEP A RECRD:
for example:
malicious files:
|IOC       |444.exe             |Executable file name (obfuscation: VBA       |
|          |                    |expression)                                  |
|IOC       |cmd.exe             |Executable file name (obfuscation: VBA       |
|          |                    |expression)                                  |
|IOC       |hell.exe            |Executable file name (obfuscation: VBA       |
|          |                    |expression)    
malicious strings(hex-encode or base64):

|VBA string|" goto loop         |Chr(34) + " goto loop"                       |
|VBA string|strRT =             |"strRT = " + Chr(34) + "h" +                 |
|          |"http://91.220.131  |Chr(Asc(Chr(Asc("t")))) + "t" + "p" +        |
|          |                    |"://91.220.131"                              |
|VBA string|.exe"               |"." + Chr(Asc("e")) + Chr(Asc("x")) + "e" +  |
|          |                    |Chr(34)                                      |

malicious ip addresses contacted:
|IOC       |1.3.1.2             |IPv4 address                                 |
|IOC       |2.2.1.1             |IPv4 address                                 |
|IOC       |1.1.2.2             |IPv4 address                                 


3. Dynamic Analysis
-------------------
- Process Activity (Parent/Child Processes, Command Execution)
  *A suspicious cmd.exe is executed as a subprocess
  *malicious execution of script Cscript.exe  
  
- Network Activity (Connections, Domains, Ports, Data Exfiltration)
  *NO SUSPICIOUS NETWORK ACTIVITY DETECTED
   all the contacted domains and ips are whitelisted nad not found malicious/suspicious.
   apart from this unknown reputation ip:91.220.131.44:80   this even matches the ip found by static analysis

- Persistence Mechanisms (Scheduled Tasks, Registry Modifications, Dropped Files)
 *Dropped multiple binary files and text files,some powershell.exe and registry modifications are also captured
  -adobeacd-update.bat
  -adobeacd-update.vbs
  
4. Observations & Summary
-------------------------
- Overall Threat Level: extremely malicious
- Malware Type:Found as TrojanDownloader,vba macro amd Trojan
- Key Indicators:
   -Malicious IP: 91.220.131.44
   -Suspicious dropped files: adobeacd-update.vbs, design.LNK
   -Persistence mechanisms: Dropped files and registry modifications.
- Impact: 
   -possibly establishing a connection with c2c server can potentially exfiltrate,modify,delete critical files.
   -dropped files/binaries can potentially modify registry keys
   -uses string obfuscation techniques like base64 and hex encoding to avoid detection
- Recommended Actions:
   -If the file has been executed immediate Containment of the Host machine
   -eradication of the malicious dropped files
   -Recommended incidence response team to start the recovery process
   -measures to avoid such incidents in future must be implemented

